!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.host=t()}}(function(){var t;return function e(t,n,i){function r(s,a){if(!n[s]){if(!t[s]){var f="function"==typeof require&&require;if(!a&&f)return f(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){var n=t[s][1][e];return r(n?n:e)},u,u.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e){var n=t("gardr-host");e.exports=n},{"gardr-host":3}],2:[function(t,e){function n(t){return"string"==typeof t&&-1!==t.indexOf("px")?t:"string"==typeof t&&-1===t.indexOf("%")||"number"==typeof t?t+"px":t}function i(t){return t.origin||t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")}function r(t,e){if("string"!=typeof t||!t)throw new Error("Iframe missing id");if(this.id=t,!e||"undefined"==typeof e.iframeUrl)throw new Error("Iframe missing options and iframeUrl");this.element=null,this.iframeUrl=e.iframeUrl,this.width=e.width||"100%",this.height=e.height||"100px",this.classes=e.classes||"",this.hidden=e.hidden,this.setData(e.data||{})}var o=1,s="gardr",a="refresh-"+s,f=s+"-failed";r.prototype.remove=function(){return this.wrapper.parentNode.removeChild(this.wrapper),this.wrapper=null,this.element=null,this},r.prototype.resize=function(t,e){return t&&(this.width=t),e&&(this.height=e),this.element&&this.element.style&&(this.element.style.width=n(this.width),this.element.style.height=n(this.height)),this},r.prototype.addFailedClass=function(){var t;this.wrapper&&-1===(t=this.wrapper.className.indexOf())&&(this.wrapper.className=t+" "+f)},r.prototype.setData=function(t){t.origin=i(document.location),t.id=this.id,this.data=t},r.prototype._getUrl=function(t){var e=this.iframeUrl;if("string"!=typeof e)throw new Error("iframeUrl must be a string");var n=-1!==e.indexOf("?")?"&":"?",i=t&&-1===t.indexOf(a)?a+"=true&":"",r=JSON.stringify(this.data),s=[e,n,"ver=",o,"&",i,"#",encodeURIComponent(r)].join("");return s.length>=2083&&(s=s.split("#")[0],this.element.name=r),s},r.prototype.refresh=function(){this.element.src=this._getUrl(this.element.src)},r.prototype._createIframeElement=function(){return document.createElement("iframe")},r.prototype.makeIframe=function(){var t=this.wrapper=document.createElement("div"),e=this.element=this._createIframeElement(),i=document.createElement("div"),r=[s,s+"-"+this.id];return this.classes&&r.push(this.classes),this.hidden&&(r.push(s+"-hidden"),t.style.display="none"),t.className=r.join(" ").toLowerCase(),t.setAttribute("data-"+s,this.id),e.setAttribute("data-automation-id",this.id),e.src=this._getUrl(),e.className=s+"-iframe",e.marginWidth=0,e.marginHeight=0,e.frameBorder="0",e.allowTransparency="true",e.style.width=n(this.width),e.style.height=n(this.height),e.style.border="0",e.style.display="block",e.style.overflow="hidden",e.scrolling="no",i.appendChild(e),i.className=s+"-inner",t.appendChild(i),this},e.exports=r},{}],3:[function(t,e){var n=t("./manager.js"),i=t("gardr-core-plugin").pluginHandler;e.exports=function(t){return new n(t,i)},e.exports.plugin=function(t){i.register(t)}},{"./manager.js":4,"gardr-core-plugin":9}],4:[function(t,e){(function(n){"use strict";function i(t){t=t||"";var e=p.decode(t.replace(/^#/,""));return e.loglevel?parseInt(e.loglevel,10):0}function r(t){t=t||"";var e=p.decode(t.replace(/^#/,""));return e.logto}function o(t,e){"function"==typeof e&&(t._callbacks=t._callbacks||[],t._callbacks.push(e))}function s(t){return t._callbacks||[]}function a(t,e){this.items=[],this.itemConfigs={},t=t||{},this.callbacks={},this.inject={},this.flags={},t.urlFragment=t.urlFragment||n.location.hash,this.logLevel=i(t.urlFragment),this.logTo=r(t.urlFragment),this.logLevel>0&&(this.inject.loglevel=this.logLevel,this.logTo&&(this.inject.logto=this.logTo)),m.forEach(function(e){if(!t[e])throw new Error("mising option for "+e);this[e]=t[e]}.bind(this)),this.pluginApi=new l,e.initPlugins(this.pluginApi,t),g.add(n,"pageshow",function(t){t.persisted===!0&&this.refreshAll(this.lastOrder)}.bind(this),!1),d.on("rendered",function(t){var e=this._getById(t.data.id);if(e){var n=e.rendered.times;u(e.rendered,t.data),e.rendered.times=n,this._resolve(e)}}.bind(this))}function f(t){return"string"!=typeof t?[]:t.split(",")}var h=t("./state.js"),u=t("util-extend"),c=t("./iframe.js"),l=t("gardr-core-plugin").PluginApi,d=t("cross-domain-events"),p=t("query-params"),g=t("eventlistener"),m=["iframeUrl"];a._xde=d,a._Iframe=c,a._setIframe=function(t){c=t};var E=a.prototype;E.extendInframeData=function(t){t&&u(this.inject,t)},E._get=function(t){return this.items.filter(function(e){return e.name===t})},E._getById=function(t){for(var e=0,n=this.items.length;n>e;e++)if(this.items[e].id===t)return this.items[e]},E._getConfig=function(t){return this.itemConfigs[t]},E.config=function(t,e){this.itemConfigs[t]=e||{}},E.queue=function(t,e){var n=e||{};if(!t)throw new Error("Can't queue without a name");var i=this._getConfig(t)||{};i.container||n.container||(n.container=document.body.appendChild(document.createElement("div")));var r=h.create(t,u(u({},i),n));this.items.push(r)},E.render=function(t,e){this._forEachWithName(t,function(n){if(!n.isActive()){if(o(n,e),!n)return this._failed(n,t+" missing item");if(!n.options.container||!n.options.url)return n.set(h.INCOMPLETE),this._failed(n,t+" missing queued config");if("string"==typeof n.options.container&&(n.options.container=document.getElementById(n.options.container),!n.options.container))return this._failed(n,t+" missing container");this.pluginApi.trigger("item:beforerender",n),this.createIframe(n),n.set(h.ACTIVE),n.options.container.appendChild(n.iframe.wrapper)}})},E.renderAll=function(t,e){"function"==typeof t&&(e=t,t=void 0),this.lastOrder=t;var n=f(t),i=function(){n.length>0?this.render(n.shift(),function(){e.apply(this,arguments),i()}):this._renderUntouched(e)}.bind(this);i()},E._getItemData=function(t){return u(t.getData(),this.inject)},E.createIframe=function(t){t.iframe||(t.iframe=new c(t.id,{iframeUrl:this.iframeUrl,width:t.options.width,height:t.options.height,hidden:t.options.hidden,classes:"",data:this._getItemData(t)}),t.iframe.makeIframe())},E._setCallback=function(t,e){var n=this.callbacks[t];this.callbacks[t]||(n=this.callbacks[t]=[]),"function"==typeof e&&n.push(e)},E._runCallbacks=function(t,e){for(var i=s(t)||[],r=i.length;r>0;)i.shift().apply(n,e),r--},E._resolve=function(t,e,n){var i="done";e&&(i="fail"),t&&n!==!0&&(t.rendered.times++,t.set(h.RESOLVED)),this.pluginApi.trigger("item:afterrender",t),t&&"function"==typeof t.options[i]&&t.options[i](e,t),(t&&t.isResolved()||e)&&this._runCallbacks(t,[e,t])},E._failed=function(t,e){t&&t.set(h.FAILED),this._resolve(t,new Error(e),!0)},E._checkResolvedStatus=function(){return this.items.every(function(t){return t.isResolved()})},E._forEachItem=function(t){this.items.forEach(t.bind(this))},E._forEachWithName=function(t,e){this._get(t).forEach(e.bind(this))},E._renderUntouched=function(t){this._forEachItem(function(e){e.isActive()===!1&&this.render(e.name,t)})},E._refreshUntouched=function(t){this._forEachItem(function(e){e.needsRefresh()===!0&&this.refresh(e.name,t)})},E.refresh=function(t,e){this._forEachWithName(t,function(n){if(o(n,e),!n)return e(new Error("Missing config "+t));if(n.isUsable()){n.iframe.setData(this._getItemData(n)),n.set(h.REFRESHING);try{n.iframe.refresh()}catch(i){n.iframe=null,n.set(n.DESTROYED),this.render(t,e)}}else this._failed(n,"item is not usable")})},E.refreshAll=function(t,e){"function"==typeof t&&(e=t,t=void 0),this._forEachItem(function(t){t.set(h.NEEDS_REFRESH)});var n=f(t),i=function r(){n.length>0?this.refresh(n.shift(),function(){e.apply(this,arguments),r()}):this._refreshUntouched(e)}.bind(this);i()},e.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./iframe.js":2,"./state.js":5,"cross-domain-events":6,eventlistener:7,"gardr-core-plugin":9,"query-params":11,"util-extend":12}],5:[function(t,e){function n(t,e){i(this,o),this.rendered=i({},a),this.options=i(i({},s),e),this.name=t,this.id=t+ ++h}var i=t("util-extend"),r={CREATED:0,REMOVED:1,NEEDS_REFRESH:2,DESTROYED:3,ACTIVE:10,REACTIVATED:11,REFRESHING:12,FAILED:20,TIMED_OUT:21,REJECTED:22,INCOMPLETE:23,RESOLVED:30},o={state:r.CREATED,name:null,iframe:null,options:null,_callbacks:null,rendered:null},s={done:null,url:null,width:null,height:null,container:null,retries:5,timeout:200,minSize:39,hidden:!1},a={times:0,width:null,height:null},f=/(GARDR|PASTIES)_UNIQUE_ID/,h=0;i(n,r);var u=n.prototype;u.isActive=function(){return this.state>=10},u.isResolved=function(){return this.state>=30},u.isUsable=function(){return this.state!==n.REJECTED&&this.state!==n.INCOMPLETE},u.needsRefresh=function(){return this.state===n.NEEDS_REFRESH};var c=29;u.hasFailed=function(){return this.isActive()&&this.state>=n.FAILED&&this.state<=c},u.set=function(t){this.lastState=this.state,this.state="number"==typeof t?t:n[t]},u.getData=function(){for(var t=this.options.url;t&&f.test(t);)t=t.replace(f,""+(new Date).getTime()+this.id);return{name:this.name,minSize:this.options.minSize,timeout:this.options.timeout,url:t,width:this.options.width,height:this.options.height,data:this.options.data}},n.create=function(t,e){return new n(t,e)},n._UNIQUE_TOKEN_REGEX=f,e.exports=n},{"util-extend":12}],6:[function(t,e,n){!function(t,i){function r(t){var e;if(a.targetOrigin==u||t.origin===a.targetOrigin){if(e=t.data,"string"==typeof t.data)try{e=JSON.parse(t.data)}catch(n){}if(e&&e.__xde===!0){e.origin=t.origin,e.source=t.source;var i=f[e.name];i&&i.length>0&&i.forEach(function(t){t(e)})}}}function o(t){if(!t||"string"!=typeof t)throw new Error("Event name has to be a string")}function s(t,e){if(o(t),"function"!=typeof e)throw new Error("Callback function has to be given")}var a,f,h,u="*";a={on:function(t,e){s(t,e),"undefined"==typeof f[t]&&(f[t]=[]),f[t].push(e)},off:function(t,e){s(t,e);var n=f[t];n&&(f[t]=n.filter(function(t){return t!==e}))},sendTo:function(t,e,n){o(e);try{t&&t.contentWindow&&(t=t.contentWindow)}catch(i){}if(!t||!t.postMessage)throw new TypeError("otherWindow does not support postMessage");var r={name:e,data:n,__xde:!0};h&&(r=JSON.stringify(r)),t.postMessage(r,this.targetOrigin)},targetOrigin:u,_reset:function(e){f={},this.targetOrigin=u,h=e||!1;try{t.postMessage({toString:function(){h=!0}},"*")}catch(n){}}},a._reset(),i.add(window,"message",r,!1),"object"==typeof n?e.exports=a:t.xde=a}(this,this.eventListener||t("eventlistener"))},{eventlistener:7}],7:[function(e,n,i){!function(e,r){"function"==typeof t&&t.amd?t(r):"object"==typeof i?n.exports=r():e.eventListener=r()}(this,function(){function t(t,e){return function(n,i,r,o){n[t]?n[t](i,r,o):n[e]&&n[e]("on"+i,r)}}return{add:t("addEventListener","attachEvent"),remove:t("removeEventListener","detachEvent")}})},{}],8:[function(t,e){function n(t,e){return s[t]?s[t][e]:void 0}function i(t,e,n){s[t]=s[t]||{},s[t][e]=n}function r(t,e,i){if("number"!=typeof t&&"string"!=typeof e&&"function"!=typeof i)throw new Error("Invalid arguments");var r=n(t,"listeners");r[e]||(r[e]=[]),r[e].push(i)}function o(t,e){var i=n(t,"listeners")[e],r=Array.prototype.slice.call(arguments,2);i&&i.forEach(function(t){t.apply(null,r)})}var s={},a=0,f=function(){this.id=a++,i(this.id,"listeners",{}),this.on=r.bind(null,this.id),this.trigger=o.bind(null,this.id),this._reset=function(){i(this.id,"listeners",{})}};e.exports=f},{}],9:[function(t,e){e.exports={PluginApi:t("./PluginApi.js"),pluginHandler:t("./pluginHandler.js")}},{"./PluginApi.js":8,"./pluginHandler.js":10}],10:[function(t,e){var n=[];e.exports={register:function(t){if("function"!=typeof t)throw new Error("Plugin has to be a function");n.push(t)},initPlugins:function(t,e){if(!t)throw new Error("Expected a PluginApi instance");delete t._reset,Object.freeze&&Object.freeze(t),n.forEach(function(n){n(t,e||{})})},_reset:function(){n.length=0}}},{}],11:[function(t,e){function n(t,e){var n,i=[];for(n in t)null!=t[n]&&"object"!=typeof t[n]&&"function"!=typeof t[n]&&i.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return i.join(e||"&")}function i(t,e){e=e||r;for(var n,i,o,s={},a=t.split(e),f=0,h=a.length;h>f;f++)o=a[f].indexOf("="),n=a[f].substring(0,o),i=a[f].substring(o+1),i&&(s[decodeURIComponent(n)]=decodeURIComponent(i));return s}var r=/&amp;|&|;/gim;e.exports={encode:n,decode:i}},{}],12:[function(t,e){function n(t,e){if(!e||"object"!=typeof e)return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}e.exports=n},{}]},{},[1])(1)});